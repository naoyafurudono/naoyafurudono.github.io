---
title: "Todo Appを作っている話"
date: 2022-08-23T16:34:04+09:00
author: "Naoya Furudono"
draft: false
---

**この記事は書きかけです。**

Todoアプリを作っている。就活の際に Webアプリの開発経験に関する話をするときの題材が欲しかったから。

GitHub: <https://github.com/naoyafurudono/todo-app>

## モチベーション

Todoアプリを選んだのは、この手の目的でよく作られているイメージがあるから。FizzBazzみたいな？
見た目だけ整えてもつまらないだろうし、コマンドラインだけで完結するようなものならSQLで良い。
作るからにはなにか自分にとって得るものやソフトウェアとして売りになる点が欲しい。

## 技術の話

細かいことはreadmeにしっかり書いている。しっかり書いたことも頑張りの一つ。ソフトウェア設計のためのツールを勉強できた。
この記事では技術を選んだ理由や学んだことを書く。

### フロント

フロントはTypeScriptとReactを用いた。

#### TypeScriptに関して

JSではなくTSを使ったのは、僕が常々型がほしいと思っていて、仕事でも型を大事にしたプログラミングをしたいから。
TypeScriptはほとんど初めて書いた。型システム（といってよいのだろうか）にはクセがあるが、
型システムがいてくれてよかったと思う機会が何度かあった。
これが静的型付言語を用いたプログラミング体験で最良だとは思わないけど、なかなか良かった。

良かった:

- 型としての文字列リテラル
- ユニオン型
- JSONとの連携

enumというか、代数的データ型っぽくオブジェクトを使える。
網羅性検査やコード補完もしっかり効いて快適だった。
これはTSの特権だと思うのだが、JSONとの親和性がすごく良かった。

良くない:

- 関数の型を書きにくい
- ライブラリ関数の型が調べにくい、使いにくい
- 型推論の結果が欲しい型になかなかならない
- any

これらの辛さの原因は、僕の文化への慣れと、構造的部分型と型エイリアスを多用する方針のどちらかだろう。
関数の型が書きにくいのは慣れの問題だろう。Haskell基準で語っているので理想が高いのかもしれない。
型が調べにくいのは、なれとJS向けドキュメントによる検索汚染が原因か。
Reactみたいなライブラリの型を調べる際にはどこをみるべきなんだろうか。

型推論は型システムの方針の問題だろう。
たとえばオブジェクトを返す関数を書いたとき、
気持ちとしてはすでに定義してある型エイリアスを提案してほしいのだが、
実際にはレコード型みたいな形の型が推論結果としてフィードバックされる。
主要な型は確かにそのレコード型みたいな型だろうからその挙動は理解できるし、まっとうだと思いはする。
トップレベルの関数定義では、型アノテーションを書いてから本体を定義するのがやはり良いのだろう。
書きはじめのころ型アノテーションの書き方がわからなくて、VSCodeに書いてもらおうとしたときにこの不満が出たのだったと思う。

anyは本当に良くない。型をつけたプログラムをデバッグするときは、
強く型がついた前提で考えるので、any周りで前提が崩れて状況の認識に失敗する。
anyを書かないように頑張ることが必要だ。
デバッグの際にはanyの可能性を忘れず、JSの気持ちで考えるのが良いのだろうか？
それでは嬉しさ半減な気がするのだが。。。

不満が多くなってしまったが、TypeScriptはそれなりに好きだと思う。

#### Reactに関して

Reactの他にElmを使うとか、UIはしょぼくするとかの案があった。
判断の理由はReactの話に乗ってくれる人が多そうな気がしたから。
個人的に最近Reactのことを調べていて、しっかり書いてみたい気持ちもあった。

関数コンポーネントで書いたし、useEffectやuseReducerもしっかり使った（つもり）。
比較対処をそんなに知っているわけではないので、感想は少なめ。
`useEffect`とか`useReducer`はよくできているなと思った。うまい。

今回は複数クライアントがTodoを共有するようにした。WebSocketでサーバを通して
イベントの同期をとって、同期が取らたイベントだけを反映させている。
これはCroquetというメタバース環境の実装方針のアイデアを拝借した。
イベント同期のためのWebSocketクライアントの管理のために`useEffect`を使い、
イベント処理のために`useReducer`を用いた。

### サーバ

Golangを用いた。
ゴルーチンとチャンネルの使い方や、構造体型の設計がセールスポイントだろうか。
特に凝ったことをしたわけではなく、「これくらいは書けます」とアピールできるだろうと見込んでいる。
力尽きたのであとは宿題。
