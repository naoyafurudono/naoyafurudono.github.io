---
title: "感想文：Static Analysis Lessons"
date: 2022-08-31T12:36:02+09:00
author: "Naoya Furudono"
draft: true
---

[Lessons from building static analysis tools at Google](https://dl.acm.org/doi/fullHtml/10.1145/3188720)
についての感想など。

# 読んだ背景

最近EDSL (埋め込み領域特化言語) の型システムについて考えている。
EDSLはホスト言語に埋め込まれた言語で、たとえばJSにReactというEDSLが埋め込まれているみたいな使い方をするとぼくは認識している
(この解釈は一般的とは限らないことに注意。実際、React EDSLで検索しても記事がヒットしない)。

EDSLはライブラリの一種で独自の世界観を持ったものな気がしていて、もはやAPIというより言語だと言えそうなものが分類されがちなのではないだろうか。
フレームワークとの区別は組み合わせ方の問題？このあたりは脇道なので話をもどそう。

EDSLはホスト言語の型システムで型検査される。エラーがある場合にはホスト言語の型システムがそのエラーを報告することになる。
ここでEDSLの世界観とホスト言語の世界観のズレがすごいと、エラーメッセージはひどいことになるのではないか、と思って調査をしている。
さらにホスト言語の型システムが良い性質をもつと、EDSLのお作法を型検査で強制できて幸せだろうとも思っている。

とはいえこれらの問題を型システムでなんとかするのは常に素直な解決策ではないだろう。
コンパイラから独立した静的解析ツールを別途導入するのはありがちな手法なんじゃないだろうか。
Reactなんかはそう。TSの恩恵も受けて入るだろうけど、たとえば `useEffect` の依存配列の内容は
外部の静的解析ツールで検知する。
そういうわけで静的解析ツールはソリューションとして無視できないし、一定効果を上げていてユーザに受け入れられていそうだ。

ではその弱みとか、強みとかを特徴づける要素はなにで、型システムにこすりつけるのと比べてどんな利点欠点があるだろうか。
それを調べるための手がかりとして、冒頭で上げた記事を参考にできそうだ。

# 記事の要約

wip

# 記事の感想

[Clangに内蔵させた方式がうまく行った](https://dl.acm.org/doi/fullHtml/10.1145/3188720#:~:text=%C2%A0%20Make%20It%20a%20Compiler%20Workflow)
と書かれている箇所は僕の見立てと同じ方向を向いているかもしれない。
型に限った話ではないので、ピッタリ同じというわけではないことに注意。論文が学会に投稿されている:
[Large-Scale Automated Refactoring Using ClangMR](https://research.google/pubs/pub41342/)。
コンパイラを使う利点も最初のリンク先に書かれているので必要に応じて引用すると良いだろう。

コンパイラによるチェックが満たしたほうが良さげな指標として次があげられている。

> report issues affecting only correctness rather than style or best practices

wip
