---
title: "2023-07-22"
date: 2023-07-22T11:56:59+09:00
author: "Naoya Furudono"
draft: false
tags: [
    "daily"
    ,"PL"
    ,"tech"
]
---

コンパイラの実装で、次はポインタ算術をやる。
演算子がオーバーローディングされているので型検査が必要。
今は環境とかのデータ構造を設計する気力がなくて、パソコンを前にふにゃっとしている。
お昼ご飯食べたら考える。

興味本位でコンパイルしたプログラムの実行速度を測ってみた。
時間計算量が試数時間なfibの実装（あのみんな大好きなナイーブなやつ）で、
fib(40)を計算してみた。自作コンパイラだとuser時間が1.3secくらいなのに対して、
gccのO3でuser時間が0.3secくらいだった。
O3を指定しないと（多分O2）0.5secくらい。
Inliningとかは効かないだろうし、ループ周りでの最適化もできないはず。
スタックマシンではなくレジスタマシンとして動かすことで（無駄なpush/popを排除することで）
O2くらいの速さになってる感じかな。
O3では何が早くなってるんだろう。気が向いたら調べるか、実装するかしたい。

